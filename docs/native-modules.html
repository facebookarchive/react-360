<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Native Modules · React 360</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Native Modules · React 360"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/react-360/index.html"/><meta property="og:description" content="Native Modules provide the ability for React code to call back into your runtime, and provide functionality that&#x27;s only available in the main browser environment. Examples include storing values between loads, requesting information about connected controllers, or manipulating the rendered environment."/><meta property="og:image" content="https://facebook.github.io/react-360/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://facebook.github.io/react-360/img/docusaurus.png"/><link rel="shortcut icon" href="/react-360/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="React 360 Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="React 360 Blog RSS Feed"/><link rel="stylesheet" href="/react-360/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/react-360/"><img class="logo" src="/react-360/img/logo.svg" alt="React 360"/><h2 class="headerTitle">React 360</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/react-360/docs/setup.html" target="_self">Docs</a></li><li class=""><a href="/react-360/docs/example-slideshow.html" target="_self">Examples</a></li><li class=""><a href="/react-360/blog" target="_self">Blog</a></li><li class=""><a href="https://github.com/facebook/react-360" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Concepts</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/react-360/docs/setup.html">Create Your First Project</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/explore-code.html">Exploring the Code</a></li></ul></div><div class="navGroup navGroupActive"><h3>Concepts</h3><ul><li class="navListItem"><a class="navItem" href="/react-360/docs/what-is.html">What is React 360?</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/runtime.html">Runtime</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/photos-and-videos.html">360 Photos and Videos</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/surfaces.html">Surfaces</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/objects.html">3D Objects</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/layout.html">Layout</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/audio.html">Playing Audio</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/input.html">Input Handling</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/react-360/docs/native-modules.html">Native Modules</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/from-react-vr.html">Legacy React VR Apps</a></li></ul></div><div class="navGroup navGroupActive"><h3>Publishing</h3><ul><li class="navListItem"><a class="navItem" href="/react-360/docs/publish.html">Build for Production</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/static-assets.html">Static Assets</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/integrate.html">Integrate with Another Site</a></li></ul></div><div class="navGroup navGroupActive"><h3>Components</h3><ul><li class="navListItem"><a class="navItem" href="/react-360/docs/view.html">View</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/text.html">Text</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/image.html">Image</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/entity.html">Entity</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/vr-button.html">VrButton</a></li></ul></div><div class="navGroup navGroupActive"><h3>APIs</h3><ul><li class="navListItem"><a class="navItem" href="/react-360/docs/animated.html">Animated</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/async-storage.html">AsyncStorage</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/controller-info.html">ControllerInfo</a></li><li class="navListItem"><a class="navItem" href="/react-360/docs/environment.html">Environment</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/react-360/tree/master/docs/native-modules.md" target="_blank" rel="noreferrer noopener">Edit</a><h1>Native Modules</h1></header><article><div><span><p>Native Modules provide the ability for React code to call back into your runtime, and provide functionality that's only available in the main browser environment. Examples include storing values between loads, requesting information about connected controllers, or manipulating the rendered environment.</p>
<h2><a class="anchor" aria-hidden="true" id="custom-native-modules"></a><a href="#custom-native-modules" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Native Modules</h2>
<h3><a class="anchor" aria-hidden="true" id="creating-new-native-modules"></a><a href="#creating-new-native-modules" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating New Native Modules</h3>
<p>Native Modules are created in your runtime code (client.js), and need to be registered at startup time before React can use them. A sample application demonstrating the many uses of Native Modules is <a href="/react-360/docs/example-native-modules.html">available here</a>. Each aspect of Native Modules will be described below.</p>
<p>To create a Native Module, you need to extend <code>Module</code> and register it at initialization time.</p>
<pre><code class="hljs css js"><span class="hljs-keyword">import</span> {Module} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360-web'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>(<span class="hljs-string">'MyModule'</span>); <span class="hljs-comment">// Makes this module available at NativeModules.MyModule</span>
  }

  <span class="hljs-comment">// This method will be exposed to the React app</span>
  doSomething() {

  }
}

<span class="hljs-keyword">const</span> r360 = <span class="hljs-keyword">new</span> ReactInstance(
  <span class="hljs-string">'MyApp.bundle?platform=vr'</span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'container'</span>),
  {
    <span class="hljs-comment">// Register custom modules at init time</span>
    nativeModules: [
      <span class="hljs-keyword">new</span> MyModule(),
    ]
  }
);
</code></pre>
<p>The <code>nativeModules</code> array can either receive Native Module instances directly, or a function that will return a Native Module instance. This second case can be helpful if you need to supply values at construction time, as you'll see later on.</p>
<h3><a class="anchor" aria-hidden="true" id="exposing-constants-to-react"></a><a href="#exposing-constants-to-react" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Exposing Constants to React</h3>
<p>The simplest use case for Native Modules is to pass constant values from the main browser window to React. These are values known at initialization time that do not change, like the browser's language or user agent string. Any values attached to your Native Module in the constructor <em>which do not start with an underscore</em> will be available in React.</p>
<pre><code class="hljs css js"><span class="hljs-comment">// in client.js</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>(<span class="hljs-string">'MyModule'</span>);
    someConstant = <span class="hljs-number">42</span>;
  }
}
</code></pre>
<pre><code class="hljs css js"><span class="hljs-comment">// in index.js</span>
<span class="hljs-keyword">import</span> {NativeModules} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360'</span>;
<span class="hljs-keyword">const</span> {MyModule} = NativeModules;

assert(MyModule.someConstant === <span class="hljs-number">42</span>);
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="simple-methods"></a><a href="#simple-methods" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple Methods</h3>
<p>To trigger an effect in the main browser window that doesn't require any feedback, simply add a method to your Native Module class. It can be called on the React side, and the arguments will be copied over to the Runtime. This effect can be seen in the Native Modules example with the method that sets the browser window title.</p>
<p><strong>NOTE:</strong> if you need to add a method to your Native Module class that you don't want accessible on the React side, prefix it with an underscore.</p>
<h3><a class="anchor" aria-hidden="true" id="methods-with-callbacks"></a><a href="#methods-with-callbacks" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Methods with Callbacks</h3>
<p>Often, a Native Module method is used to retrieve data from the main browser window. Due to the asynchronous communication between the React code and the Runtime, values cannot be returned from your Native Module methods. Instead, the value needs to be passed to a callback method, a standard JavaScript technique for asynchronous communication.</p>
<p>Once the Native Module has fetched the necessary data, it needs to invoke the callback using the <code>ReactNativeContext</code>. This requires a reference to that context, which can be provided at initialization time.</p>
<pre><code class="hljs css js"><span class="hljs-comment">// in client.js</span>

<span class="hljs-keyword">import</span> {Module} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360-web'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> </span>{
  <span class="hljs-keyword">constructor</span>(ctx) {
    <span class="hljs-keyword">super</span>(<span class="hljs-string">'MyModule'</span>);

    <span class="hljs-keyword">this</span>._ctx = ctx;
  }

  getValueWithCallback(id) {
    ctx.invokeCallback(
      id, <span class="hljs-comment">// callback id, passed to the method</span>
      [<span class="hljs-number">42</span>, <span class="hljs-string">'hello'</span>] <span class="hljs-comment">// array of arguments passed to callback</span>
    );
  }
}

<span class="hljs-keyword">const</span> r360 = <span class="hljs-keyword">new</span> ReactInstance(
  <span class="hljs-string">'MyApp.bundle?platform=vr'</span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'container'</span>),
  {
    <span class="hljs-comment">// Register custom modules at init time</span>
    nativeModules: [
      <span class="hljs-function"><span class="hljs-params">ctx</span> =&gt;</span> <span class="hljs-keyword">new</span> MyModule(ctx), <span class="hljs-comment">// Use the function initializer</span>
                                <span class="hljs-comment">// to get the context</span>
    ]
  }
);
</code></pre>
<pre><code class="hljs css js"><span class="hljs-comment">// in index.js</span>
<span class="hljs-keyword">import</span> {NativeModules} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360'</span>;
<span class="hljs-keyword">const</span> {MyModule} = NativeModules;

MyModule.getValueWithCallback(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
  assert(a === <span class="hljs-number">42</span>);
  assert(b === <span class="hljs-string">'hello'</span>);
});
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="methods-returning-promises"></a><a href="#methods-returning-promises" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Methods Returning Promises</h3>
<p>In modern JavaScript, Promises are often favored as a method of asynchronous communication. Instead of using callbacks directly, you can create Native Module methods that return Promises by appending their names with a dollar sign ($). The dollar sign will be ignored on the React side when the method is called. Two callback IDs will be automatically passed to the Runtime, representing the <code>resolve</code> and <code>reject</code> methods of the Promise.</p>
<pre><code class="hljs css js"><span class="hljs-comment">// in client.js</span>

<span class="hljs-keyword">import</span> {Module} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360-web'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> </span>{
  <span class="hljs-keyword">constructor</span>(ctx) {
    <span class="hljs-keyword">super</span>(<span class="hljs-string">'MyModule'</span>);

    <span class="hljs-keyword">this</span>._ctx = ctx;
  }

  $getValueWithPromise(resolveID, rejectID) {
    <span class="hljs-comment">// Resolve the Promise</span>
    ctx.invokeCallback(
      resolveID,
      [<span class="hljs-number">42</span>] <span class="hljs-comment">// array of arguments passed to resolve method</span>
    );
  }
}

<span class="hljs-keyword">const</span> r360 = <span class="hljs-keyword">new</span> ReactInstance(
  <span class="hljs-string">'MyApp.bundle?platform=vr'</span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'container'</span>),
  {
    <span class="hljs-comment">// Register custom modules at init time</span>
    nativeModules: [
      <span class="hljs-function"><span class="hljs-params">ctx</span> =&gt;</span> <span class="hljs-keyword">new</span> MyModule(ctx),
    ]
  }
);
</code></pre>
<pre><code class="hljs css js"><span class="hljs-comment">// in index.js</span>
<span class="hljs-keyword">import</span> {NativeModules} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-360'</span>;
<span class="hljs-keyword">const</span> {MyModule} = NativeModules;

MyModule.getValueWithPromise().then(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {
  assert(value === <span class="hljs-number">42</span>);
});
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="input.html">← Input Handling</a><a class="docs-next button" href="from-react-vr.html">Migrating from React VR →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#custom-native-modules">Custom Native Modules</a><ul class="toc-headings"><li><a href="#creating-new-native-modules">Creating New Native Modules</a></li><li><a href="#exposing-constants-to-react">Exposing Constants to React</a></li><li><a href="#simple-methods">Simple Methods</a></li><li><a href="#methods-with-callbacks">Methods with Callbacks</a></li><li><a href="#methods-returning-promises">Methods Returning Promises</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/react-360/" class="nav-home"><img src="/react-360/img/logo.svg" alt="React 360" width="66" height="58"/></a><div><h5>Docs</h5><a href="/react-360/docs/en/setup.html">Getting Started</a><a href="/react-360/docs/en/example-slideshow.html">Examples</a></div><div><h5>More</h5><a href="/react-360/blog">Blog</a><a href="https://github.com/facebook/react-360">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/react-360/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/react-360/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Facebook Inc.</section></footer></div></body></html>